<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:assist="clr-namespace:Jg.wpf.controls.Assist"
    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:converter="clr-namespace:Jg.wpf.controls.Converter"
    xmlns:customWindows="clr-namespace:Jg.wpf.controls.Customer.CustomWindows"
    xmlns:o="http://schemas.microsoft.com/winfx/2006/xaml/presentation/options"
    xmlns:system="clr-namespace:System;assembly=System.Runtime">

    <system:Double x:Key="DefaultControlHeight">28</system:Double>
    <Thickness x:Key="DefaultControlPadding">10,5</Thickness>
    <Geometry x:Key="WindowMinGeometry" o:Freeze="True">M0,4 L10,4 L10,5 L0,5 z</Geometry>
    <Geometry x:Key="WindowMaxGeometry" o:Freeze="True">M1,1 L1,9 L9,9 L9,1 z M0,0 L10,0 L10,10 L0,10 z</Geometry>
    <Geometry x:Key="WindowRestoreGeometry" o:Freeze="True">M1,3 L1,9 L7,9 L7,3 z M3,1 L3,2 L8,2 L8,7 L9,7 L9,1 z M2,0 L10,0 L10,8 L8,8 L8,10 L0,10 L0,2 L2,2 z</Geometry>
    <Geometry x:Key="CloseGeometry" o:Freeze="True">M0.7,0 L5,4.3 L9.3,0 L10,0.7 L5.7,5 L10,9.3 L9.3,10 L5,5.7 L0.7,10 L0,9.3 L4.3,5 L0,0.7 z</Geometry>

    <converter:BooleanArr2VisibilityConverter x:Key="BooleanArr2VisibilityConverter" />
    <converter:Object2BooleanConverter x:Key="Object2BooleanConverter" />

    <Style x:Key="BaseStyle" TargetType="Control" />

    <Style
        x:Key="ButtonBaseBaseStyle"
        BasedOn="{StaticResource BaseStyle}"
        TargetType="ButtonBase">
        <Setter Property="Height" Value="{StaticResource DefaultControlHeight}" />
        <Setter Property="BorderBrush" Value="Orange" />
        <Setter Property="Padding" Value="{StaticResource DefaultControlPadding}" />
        <Setter Property="Foreground" Value="White" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
    </Style>

    <Style
        x:Key="ButtonBaseStyle"
        BasedOn="{StaticResource ButtonBaseBaseStyle}"
        TargetType="Button">
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Background" Value="#1c1c1c" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid>
                        <Border Background="{TemplateBinding Background}" />
                        <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <StackPanel
                                Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Orientation="Horizontal">
                                <Path
                                    x:Name="PathMain"
                                    Width="{TemplateBinding assist:IconElement.Width}"
                                    Height="{TemplateBinding assist:IconElement.Height}"
                                    Data="{TemplateBinding assist:IconElement.Geometry}"
                                    Fill="{TemplateBinding Foreground}"
                                    SnapsToDevicePixels="True"
                                    Stretch="Uniform" />
                                <ContentPresenter
                                    x:Name="ContentPresenterMain"
                                    Margin="6,0,0,0"
                                    VerticalAlignment="Center"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </StackPanel>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Content" Value="{x:Null}">
                            <Setter TargetName="ContentPresenterMain" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="assist:IconElement.Geometry" Value="{x:Null}">
                            <Setter TargetName="PathMain" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="ContentPresenterMain" Property="Margin" Value="0" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Opacity" Value=".9" />
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
                <Setter Property="Opacity" Value=".6" />
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.4" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style
        x:Key="ButtonIcon"
        BasedOn="{StaticResource ButtonBaseStyle}"
        TargetType="Button">
        <Setter Property="Background" Value="White" />
        <Setter Property="Foreground" Value="#212121" />
        <Setter Property="assist:BorderElement.CornerRadius" Value="0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="{Binding Path=(assist:BorderElement.CornerRadius), RelativeSource={RelativeSource TemplatedParent}}">
                        <ContentControl
                            Margin="{TemplateBinding Padding}"
                            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                            VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}">
                            <Path
                                Width="{TemplateBinding assist:IconElement.Width}"
                                Height="{TemplateBinding assist:IconElement.Height}"
                                Data="{TemplateBinding assist:IconElement.Geometry}"
                                Fill="{TemplateBinding Foreground}"
                                SnapsToDevicePixels="True"
                                Stretch="Uniform" />
                        </ContentControl>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style
        x:Key="ButtonCustom"
        BasedOn="{StaticResource BaseStyle}"
        TargetType="Button">
        <Setter Property="Background" Value="{x:Null}" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border
                        x:Name="Chrome"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="{Binding Path=(assist:BorderElement.CornerRadius), RelativeSource={RelativeSource TemplatedParent}}"
                        SnapsToDevicePixels="true">
                        <ContentPresenter
                            Margin="{TemplateBinding Padding}"
                            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                            VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                            RecognizesAccessKey="True"
                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Opacity" Value=".9" />
                            <Setter TargetName="Chrome" Property="Background" Value="{Binding Path=(assist:BackgroundSwitchElement.MouseHoverBackground), RelativeSource={RelativeSource TemplatedParent}}" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Opacity" Value=".6" />
                            <Setter TargetName="Chrome" Property="Background" Value="{Binding Path=(assist:BackgroundSwitchElement.MouseDownBackground), RelativeSource={RelativeSource TemplatedParent}}" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.4" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="Custom.Window" TargetType="{x:Type customWindows:CustomWindow}">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}" />
        <Setter Property="Background" Value="#FFF1F1F1" />
        <Setter Property="BorderBrush" Value="#15181C" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="CloseButtonBackground" Value="Transparent" />
        <Setter Property="CloseButtonForeground" Value="#212121" />
        <Setter Property="CloseButtonHoverBackground" Value="#e81123" />
        <Setter Property="CloseButtonHoverForeground" Value="White" />
        <Setter Property="OtherButtonBackground" Value="Transparent" />
        <Setter Property="OtherButtonForeground" Value="#212121" />
        <Setter Property="OtherButtonHoverBackground" Value="#20000000" />
        <Setter Property="OtherButtonHoverForeground" Value="White" />
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="ResizeMode" Value="CanResizeWithGrip" />
        <Setter Property="UseLayoutRounding" Value="True" />
        <Setter Property="TextOptions.TextFormattingMode" Value="Display" />
        <Setter Property="WindowStyle" Value="SingleBorderWindow" />
        <Setter Property="WindowTitleHeight" Value="40" />
        <Setter Property="WindowChrome.WindowChrome">
            <Setter.Value>
                <WindowChrome
                    CaptionHeight="{Binding WindowTitleHeight, RelativeSource={RelativeSource Mode=FindAncestor, AncestorLevel=1, AncestorType=customWindows:CustomWindow}}"
                    CornerRadius="0"
                    GlassFrameThickness="1"
                    NonClientFrameEdges="None"
                    UseAeroCaptionButtons="False" />
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type customWindows:CustomWindow}">
                    <Border x:Name="WindowBorder" SnapsToDevicePixels="True">
                        <Grid Background="#FF15181C">
                            <Border Height="{Binding WindowTitleHeight, RelativeSource={RelativeSource TemplatedParent}}" VerticalAlignment="Top">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0.5,1" EndPoint="0.5,0">
                                        <GradientStop Offset="1" Color="#2B313B" />
                                        <GradientStop Offset="0" Color="#181B21" />
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                            <Grid
                                x:Name="LayoutRoot"
                                Margin="0"
                                Background="{TemplateBinding Background}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid
                                    x:Name="PART_WindowTitleGrid"
                                    Grid.Row="0"
                                    Height="{Binding WindowTitleHeight, RelativeSource={RelativeSource TemplatedParent}}"
                                    Background="Orange"
                                    UseLayoutRounding="True">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            Name="ButtonIcon"
                                            Margin="10,0,0,0"
                                            VerticalAlignment="Center"
                                            Background="Transparent"
                                            Command="{x:Static SystemCommands.ShowSystemMenuCommand}"
                                            Style="{StaticResource ButtonCustom}"
                                            WindowChrome.IsHitTestVisibleInChrome="True">
                                            <Button.Visibility>
                                                <MultiBinding Converter="{StaticResource BooleanArr2VisibilityConverter}">
                                                    <MultiBinding.Bindings>
                                                        <Binding Path="ShowIcon" RelativeSource="{RelativeSource TemplatedParent}" />
                                                        <Binding
                                                            Converter="{StaticResource Object2BooleanConverter}"
                                                            Path="Icon"
                                                            RelativeSource="{RelativeSource TemplatedParent}" />
                                                    </MultiBinding.Bindings>
                                                </MultiBinding>
                                            </Button.Visibility>
                                            <b:Interaction.Triggers>
                                                <b:EventTrigger EventName="MouseDoubleClick">
                                                    <b:InvokeCommandAction Command="{x:Static SystemCommands.CloseWindowCommand}" />
                                                </b:EventTrigger>
                                            </b:Interaction.Triggers>
                                            <Image
                                                Width="32"
                                                Height="32"
                                                VerticalAlignment="Center"
                                                IsHitTestVisible="False"
                                                Source="{TemplateBinding Icon}" />
                                        </Button>
                                        <TextBlock
                                            Grid.Column="1"
                                            Padding="10,0,0,0"
                                            VerticalAlignment="Center"
                                            Text="{TemplateBinding Title}">
                                            <TextBlock.Visibility>
                                                <MultiBinding Converter="{StaticResource BooleanArr2VisibilityConverter}">
                                                    <MultiBinding.Bindings>
                                                        <Binding Path="ShowTitle" RelativeSource="{RelativeSource TemplatedParent}" />
                                                        <Binding
                                                            Converter="{StaticResource Object2BooleanConverter}"
                                                            Path="Title"
                                                            RelativeSource="{RelativeSource TemplatedParent}" />
                                                    </MultiBinding.Bindings>
                                                </MultiBinding>
                                            </TextBlock.Visibility>
                                        </TextBlock>
                                        <ContentPresenter
                                            x:Name="ContentPresenterMain"
                                            Grid.Column="2"
                                            VerticalAlignment="Center"
                                            Content="{TemplateBinding NonClientAreaContent}"
                                            WindowChrome.IsHitTestVisibleInChrome="True" />
                                    </Grid>
                                    <StackPanel
                                        x:Name="WindowCommandButtonsStackPanel"
                                        Grid.Column="1"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Top"
                                        Orientation="Horizontal"
                                        UseLayoutRounding="True"
                                        WindowChrome.IsHitTestVisibleInChrome="True">
                                        <Button
                                            x:Name="ButtonMin"
                                            Width="45"
                                            Height="29"
                                            assist:IconElement.Geometry="{StaticResource WindowMinGeometry}"
                                            assist:IconElement.Height="10"
                                            assist:IconElement.Width="10"
                                            Background="{TemplateBinding OtherButtonBackground}"
                                            BorderThickness="1,0,1,0"
                                            Command="{Binding Source={x:Static SystemCommands.MinimizeWindowCommand}}"
                                            IsTabStop="False"
                                            Style="{StaticResource ButtonIcon}"
                                            ToolTip="Minimize" />
                                        <Grid>
                                            <Button
                                                x:Name="ButtonRestore"
                                                Width="46"
                                                Height="29"
                                                assist:IconElement.Geometry="{StaticResource WindowRestoreGeometry}"
                                                assist:IconElement.Height="10"
                                                assist:IconElement.Width="10"
                                                Background="{TemplateBinding OtherButtonBackground}"
                                                BorderThickness="1,0,1,0"
                                                Command="{Binding Source={x:Static SystemCommands.RestoreWindowCommand}}"
                                                IsTabStop="False"
                                                Style="{StaticResource ButtonIcon}"
                                                ToolTip="Restore"
                                                Visibility="Collapsed" />
                                            <Button
                                                x:Name="ButtonMax"
                                                Width="46"
                                                Height="29"
                                                assist:IconElement.Geometry="{StaticResource WindowMaxGeometry}"
                                                assist:IconElement.Height="10"
                                                assist:IconElement.Width="10"
                                                Background="{TemplateBinding OtherButtonBackground}"
                                                BorderThickness="1,0,1,0"
                                                Command="{Binding Source={x:Static SystemCommands.MaximizeWindowCommand}}"
                                                IsTabStop="False"
                                                Style="{StaticResource ButtonIcon}"
                                                ToolTip="Maximize" />
                                        </Grid>
                                        <Button
                                            x:Name="ButtonClose"
                                            Width="46"
                                            Height="29"
                                            assist:IconElement.Geometry="{StaticResource CloseGeometry}"
                                            assist:IconElement.Height="10"
                                            assist:IconElement.Width="10"
                                            Background="{TemplateBinding CloseButtonBackground}"
                                            BorderThickness="1,0,0,0"
                                            Command="{Binding Source={x:Static SystemCommands.CloseWindowCommand}}"
                                            Foreground="{TemplateBinding CloseButtonForeground}"
                                            IsTabStop="False"
                                            Style="{StaticResource ButtonIcon}"
                                            ToolTip="Close" />
                                    </StackPanel>
                                </Grid>
                                <AdornerDecorator Grid.Row="1" KeyboardNavigation.IsTabStop="False">
                                    <ContentControl x:Name="MainContentPresenter" Content="{TemplateBinding Content}" />
                                </AdornerDecorator>
                                <ResizeGrip
                                    x:Name="ResizeGrip"
                                    Grid.Row="1"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    IsTabStop="False"
                                    Visibility="Hidden"
                                    WindowChrome.ResizeGripDirection="BottomRight" />
                            </Grid>
                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers>
                        <!--<Trigger Property="IsActive" Value="False">
                            <Setter Property="BorderBrush" Value="#FF6F7785" />
                        </Trigger>-->
                        <Trigger Property="WindowState" Value="Maximized">
                            <Setter TargetName="ButtonMax" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="ButtonRestore" Property="Visibility" Value="Visible" />
                            <Setter TargetName="LayoutRoot" Property="Margin" Value="7" />
                        </Trigger>
                        <Trigger Property="WindowState" Value="Normal">
                            <Setter TargetName="ButtonMin" Property="Visibility" Value="Visible" />
                            <Setter TargetName="ButtonRestore" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="NoResize">
                            <Setter TargetName="ButtonMin" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="ButtonMax" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="ButtonRestore" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <Trigger SourceName="ButtonClose" Property="IsMouseOver" Value="True">
                            <Setter TargetName="ButtonClose" Property="Background" Value="{Binding CloseButtonHoverBackground, RelativeSource={RelativeSource TemplatedParent}}" />
                            <Setter TargetName="ButtonClose" Property="Foreground" Value="{Binding CloseButtonHoverForeground, RelativeSource={RelativeSource TemplatedParent}}" />
                        </Trigger>
                        <Trigger SourceName="ButtonMax" Property="IsMouseOver" Value="True">
                            <Setter TargetName="ButtonMax" Property="Background" Value="{Binding OtherButtonHoverBackground, RelativeSource={RelativeSource TemplatedParent}}" />
                            <Setter TargetName="ButtonMax" Property="Foreground" Value="{Binding OtherButtonHoverForeground, RelativeSource={RelativeSource TemplatedParent}}" />
                        </Trigger>
                        <Trigger SourceName="ButtonRestore" Property="IsMouseOver" Value="True">
                            <Setter TargetName="ButtonRestore" Property="Background" Value="{Binding OtherButtonHoverBackground, RelativeSource={RelativeSource TemplatedParent}}" />
                            <Setter TargetName="ButtonRestore" Property="Foreground" Value="{Binding OtherButtonHoverForeground, RelativeSource={RelativeSource TemplatedParent}}" />
                        </Trigger>
                        <Trigger SourceName="ButtonMin" Property="IsMouseOver" Value="True">
                            <Setter TargetName="ButtonMin" Property="Background" Value="{Binding OtherButtonHoverBackground, RelativeSource={RelativeSource TemplatedParent}}" />
                            <Setter TargetName="ButtonMin" Property="Foreground" Value="{Binding OtherButtonHoverForeground, RelativeSource={RelativeSource TemplatedParent}}" />
                        </Trigger>

                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="ResizeMode" Value="CanResizeWithGrip" />
                                <Condition Property="WindowState" Value="Normal" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="ResizeGrip" Property="Visibility" Value="Visible" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>